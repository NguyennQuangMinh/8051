/*********************************************************************************
*
*由于P3.2口跟红外线共用，所以做按键实验时为了不让红外线影响实验效果，最好把红外线先
*取下来。
*实验效果：K3按下LED左循环，K4按下LED变右循环
*
*********************************************************************************/
#include<reg51.h>
#include<intrins.h>

#define LED	P2

sbit K3=P3^2;
sbit K4=P3^3;

void INT_init()
{
	//设置INT0
	IT0=1;//跳变沿出发方式（下降沿）
	EX0=1;//打开INT0的中断允许。
	//设置INT1
	IT1=1;
	EX1=1;
	
	EA=1;//打开总中断	
}

void delay(unsigned int n)   //延时50us误差 0us
{
    unsigned char a,b;
		for(;n>0;n--)
		{
    	for(b=1;b>0;b--)
        for(a=22;a>0;a--);
		}
}

unsigned char s=0;
void main()
{
	LED=0X01;
	INT_init();
	while(1)
	{
		if(s)
			LED=_crol_(LED,1);
		else
			LED=_cror_(LED,1);
		delay(2000);		
	}	
}

void int0()	interrupt 0		//外部中断0的中断函数
{
	delay(1);
	if(K3==0)
		s=1;
}

void int1() interrupt 2		//外部中断1的中断函数
{
	delay(1);
	if(K4==0)
		s=0;	
}