C51 COMPILER V9.60.7.0   MAIN                                                              08/28/2024 20:36:13 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\hoc\8051\Keil_C_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*******************************************************************************
   2          * 实验名     : 静态数码管实验
   3          * 使用的IO       : 数码管使用P0,键盘使用P3.0、P3.1、P3.2、P3.3
   4          * 实验效果       : 按下K1键，显示0，按下K2键，显示9，按下K3键，显示减1，按下K4键，
   5          *显示加1。
   6          * 注意     ：由于P3.2口跟红外线共用，所以做按键实验时为了不让红外线影响实验
   7          *效果，最好把红外线先取下来。
   8          *******************************************************************************/
   9          #include<reg51.h>
  10          #include<intrins.h> 
  11          
  12          #define GPIO_DIG P0
  13          
  14          sbit LSA=P2^2;
  15          sbit LSB=P2^3;
  16          sbit LSC=P2^4;
  17          
  18          sbit K1=P3^1;
  19          sbit K2=P3^0;
  20          sbit K3=P3^2;
  21          sbit K4=P3^3;
  22          
  23          unsigned char code DIG_CODE[10]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};//显示0~9的值
  24          
  25          void Delay10ms();   //延时10ms
  26           
  27          /*******************************************************************************
  28          * 函 数 名        : main
  29          * 函数功能      : 主函数
  30          * 输    入        : 无
  31          * 输    出        : 无
  32          *******************************************************************************/
  33          void main(void)
  34          {
  35   1        unsigned int i,j;
  36   1        LSA=0;
  37   1        LSB=0;
  38   1        LSC=0;
  39   1        while(1)
  40   1        {
  41   2          if(K1==0)   //检测按键K1是否按下
  42   2          {
  43   3            Delay10ms();  //消除抖动
  44   3            if(K1==0)
  45   3            {
  46   4              j=0;
  47   4            } 
  48   3            while((i<50)&&(K1==0))   //检测按键是否松开
  49   3            {
  50   4              Delay10ms();
  51   4              i++;
  52   4            }
  53   3            i=0;
  54   3          }   
  55   2          if(K2==0)      //检测按键K2是否按下
C51 COMPILER V9.60.7.0   MAIN                                                              08/28/2024 20:36:13 PAGE 2   

  56   2          {
  57   3            Delay10ms();
  58   3            if(K2==0)
  59   3            {
  60   4              j=9;
  61   4            }
  62   3            while((i<50)&&(K2==0))
  63   3            {
  64   4              Delay10ms();
  65   4              i++;
  66   4            }
  67   3            i=0;
  68   3          }     
  69   2          if(K3==0)       //检测按键K3是否按下
  70   2          {
  71   3            Delay10ms();
  72   3            if(K3==0)
  73   3            {
  74   4              j--;
  75   4              if(j>9)
  76   4                j=9;        
  77   4            }
  78   3            while((i<50)&&(K3==0))
  79   3            {
  80   4              Delay10ms();
  81   4              i++;
  82   4            }
  83   3            i=0;
  84   3          }
  85   2            
  86   2          if(K4==0)         //检测按键K4是否按下
  87   2          {
  88   3            Delay10ms();
  89   3            if(K4==0)
  90   3            {
  91   4              j++;
  92   4              if(j>9)
  93   4                j=0;
  94   4            }   
  95   3            while((i<50)&&(K4==0))
  96   3            {
  97   4              Delay10ms();
  98   4              i++;
  99   4            }
 100   3            i=0;
 101   3          }
 102   2          GPIO_DIG=DIG_CODE[j];
 103   2        }       
 104   1      }
 105          /*******************************************************************************
 106          * 函 数 名         : Delay10ms
 107          * 函数功能       : 延时函数，延时10ms
 108          * 输    入         : 无
 109          * 输    出         : 无
 110          *******************************************************************************/
 111          void Delay10ms(void)   //误差 0us
 112          {
 113   1          unsigned char a,b,c;
 114   1          for(c=1;c>0;c--)
 115   1              for(b=38;b>0;b--)
 116   1                  for(a=130;a>0;a--);
 117   1      }
C51 COMPILER V9.60.7.0   MAIN                                                              08/28/2024 20:36:13 PAGE 3   



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    260    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
