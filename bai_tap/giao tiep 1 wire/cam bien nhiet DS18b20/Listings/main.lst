C51 COMPILER V9.60.7.0   MAIN                                                              09/12/2024 20:05:42 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\hoc\8051\Keil_C_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Li
                    -stings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "C:\hoc\8051\bai_tap\Library\Delay\Delay.h"
   2          #include "C:\hoc\8051\bai_tap\Library\T0_Delay_us\T0_Delay_us.h"
   3          #include "C:\hoc\8051\bai_tap\Library\One Wire\OneWire.h"
   4          #include "main.h"
   5          #include "port.h"
   6          
   7          #define DS18B20_SKIP_ROM            0xCC //gui lenh den toan bo thiet bi (vi o day co 1 con DS18B20 nen su dung
             - SKIP ROM)
   8          #define DS18B20_CONVERT_T           0x44 // gui lenh chuyen doi nhiet do sang DS18B20
   9          #define DS18B20_READ_SCRATCHPAD     0xBE // gui lenh doc gia tri nhiet do tu trong thanh ghi SCRATCHPAD cua 
             -DS18B20 ra
  10          
  11          
  12          unsigned char code  Code7Seg[]={0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90};
  13          
  14          void main()
  15          {
  16   1        unsigned int temp;
  17   1        unsigned char int_part, decimal_part;
  18   1        //thiet lap timer 0 mode 1 (Mode timer 16 bit)
  19   1        TMOD &= 0xF0; //xoa bo nho timer 0
  20   1        TMOD |= 0x01; //set cai dat timer 0 chay mode 1
  21   1        
  22   1        while(1)
  23   1        {
  24   2          // gui lenh chuyen doi sang DS18B20
  25   2          while(OneWire_Reset());
  26   2          OneWire_Write_Byte(DS18B20_SKIP_ROM);
  27   2          OneWire_Write_Byte(DS18B20_CONVERT_T);
  28   2          
  29   2          Delay_ms(800); // cho cho DS18B20 chuyen doi gia tri sang nhiet do voi thoi gian toi da chuyen doi la 75
             -0ms
  30   2          
  31   2          // gui lenh lay gia tri tu DS18B20 ve
  32   2          while(OneWire_Reset());
  33   2          OneWire_Write_Byte(DS18B20_SKIP_ROM);
  34   2          OneWire_Write_Byte(DS18B20_READ_SCRATCHPAD);
  35   2          
  36   2          temp = OneWire_Read_Byte();               // doc ve 8 bit thap
  37   2          temp = (OneWire_Read_Byte()<<8) | temp;   // doc ve 8 bit cao va luu 16 bit lai vao bien temp
  38   2          
  39   2          int_part = temp>>4;                 // lay gia tri nguyen nhiet do
  40   2          decimal_part = temp & 0x000F;       // lay bit chua gia tri thap phan cua nhiet do
  41   2          decimal_part = decimal_part*10/16;  // doi tu nhi phan sang thap phan lay so dau tien
  42   2          
  43   2          P0 = Code7Seg[int_part/10];
  44   2          P2 = Code7Seg[int_part%10];
  45   2          P3 = Code7Seg[decimal_part];
  46   2        
  47   2        }
  48   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.60.7.0   MAIN                                                              09/12/2024 20:05:42 PAGE 2   

   CODE SIZE        =    124    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
