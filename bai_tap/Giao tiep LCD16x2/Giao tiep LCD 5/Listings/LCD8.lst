C51 COMPILER V9.60.7.0   LCD8                                                              08/22/2024 15:26:36 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE LCD8
OBJECT MODULE PLACED IN .\Objects\LCD8.obj
COMPILER INVOKED BY: C:\hoc\8051\Keil_C_v5\C51\BIN\C51.EXE ..\..\Library\LCD16x2_8bit\LCD8.c OPTIMIZE(8,SPEED) BROWSE DE
                    -BUG OBJECTEXTEND PRINT(.\Listings\LCD8.lst) TABS(2) OBJECT(.\Objects\LCD8.obj)

line level    source

   1          /*Thu vien giao tiep LCD16x2 che do 8bit
   2          Nguoi viet : Nguyen Ngoc Ngan - DH GTVT TPHCM
   3          */
   4          #include "main.h"
   5          #include <REGX52.H>
   6          #include<string.h>
   7          #include"LCD8.h"
   8          /********** khoi tao ket noi cho LCD**************/
   9          
  10          #define DATA_P P3
  11          sbit EN = P2^1;
  12          sbit RS = P2^0;
  13          
  14          /**************cac ham giao tiep LCD*************/
  15          
  16          void delay_ms( int t) 
  17          {
  18   1       unsigned int x;
  19   1       unsigned char y;
  20   1       for(x=0; x<t;x++)
  21   1        {
  22   2          for(y=0;y<123;y++);
  23   2        }
  24   1      }
  25          
  26          void LCD_cmd(char cmd) // gui lenh dieu khien
  27          {
  28   1         RS=0;
  29   1         DATA_P = cmd;
  30   1         EN = 0;
  31   1         EN = 1;
  32   1        if (cmd<=0x02)    
  33   1        delay_ms(2);    // thoi gian thuc hien lenh
  34   1        else 
  35   1        delay_ms(1);    // thoi gian thuc hien lenh
  36   1      }
  37          
  38          void LCD_clr()
  39          {
  40   1        LCD_cmd(0x01);  // xoa toan bo noi dung tren LCD
  41   1        LCD_cmd(0x02);  // dua con tro ve vi tri dau LCD
  42   1      }
  43          void LCD_PutChar( char c)   // ghi ky tu vào LCD
  44          {
  45   1         RS = 1;
  46   1         DATA_P = c;
  47   1         EN = 0;
  48   1         EN = 1;
  49   1         delay_ms(2);
  50   1      }
  51          void LCD_Puts(char *s)     //ghi chuoi vao LCD
  52          {
  53   1        int i;
  54   1        while(s[i]!='\0')
C51 COMPILER V9.60.7.0   LCD8                                                              08/22/2024 15:26:36 PAGE 2   

  55   1        {
  56   2          LCD_PutChar(s[i]);
  57   2          i++;
  58   2        }
  59   1      }
  60          
  61          void LCD_gotoXY(unsigned char col, unsigned char row)  // di chuyen con tro den vi tri bat ki (row,colum)
  62          {
  63   1       if(row==1)
  64   1         {
  65   2          LCD_cmd(0x80+col-1);  // 0x80 bat dau tu cot 1, dong 1
  66   2         }
  67   1       else LCD_cmd(0xC0+col-1);   // 0xC0 bat dau tu cot 1, dong 2
  68   1      
  69   1      }
  70          
  71          void LCD_Shift(bit DIR)
  72          {
  73   1        if(DIR==0)  LCD_cmd(0x18);      // dich noi dung sang trai
  74   1        else LCD_cmd(0x1C);         // dich noi dung sang phai
  75   1      }
  76          
  77          void LCD_PutLongText(char *t,unsigned char row)
  78          {
  79   1         int i; 
  80   1         int k=0;
  81   1         while(t[k]!='\0')  // xet toan bo chuoi ky tu
  82   1         {
  83   2          LCD_gotoXY(1,row);
  84   2          if(k+16> strlen(t)) k=0;
  85   2          for(i=k;i<k+16;i++)  // in lan luot 16 ky tu trong gioi han man hinh
  86   2               {
  87   3                LCD_PutChar(t[i]);
  88   3               }
  89   2          if(k==0||k==strlen(t)-1)
  90   2          delay_ms(1500);
  91   2          delay_ms(500);
  92   2      
  93   2           k++;         // cap nhat vi tri in  
  94   2         }
  95   1      }
  96          
  97          void LCD_init()
  98          {
  99   1          LCD_cmd(0x01);    // xoa noi dung LCD
 100   1          LCD_cmd(0x30);    // dam bao on dinh LCD
 101   1          delay_ms(5);
 102   1          LCD_cmd(0x30);
 103   1          delay_ms(1);
 104   1          LCD_cmd(0x30);
 105   1          delay_ms(1);      
 106   1          LCD_cmd(0x38);    // khoi tao LCD mode 8bit, font 5x8
 107   1          LCD_cmd(0x06);    // con tro o vi tri tiep theo
 108   1          LCD_cmd(0x0C);    // bat hien thi, tat con tro
 109   1         // LCD_cmd(0x0E);    // bat hien thi, tat con tro
 110   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    381    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.60.7.0   LCD8                                                              08/22/2024 15:26:36 PAGE 3   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      13
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       1
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
